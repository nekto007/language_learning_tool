{% extends "base.html" %}

{% block content %}
  <!-- Compact Header -->
  <div class="lesson-header">
    <div class="lesson-header-left">
      <span class="lesson-type-badge">
        {% if lesson.type == 'vocabulary' %}
          ğŸ“š
        {% elif lesson.type == 'grammar' %}
          âœï¸
        {% elif lesson.type == 'quiz' %}
          â“
        {% elif lesson.type == 'text' %}
          ğŸ“„
        {% elif lesson.type in ['card', 'anki_cards'] %}
          ğŸ—‚ï¸
        {% elif lesson.type == 'final_test' %}
          ğŸ†
        {% else %}
          ğŸ“
        {% endif %}
        {{ component_name|default(translate_lesson_type(lesson.type)) }}
      </span>
      <h1 class="lesson-title">{{ lesson.title }}</h1>
    </div>
    <div class="lesson-progress-compact">
      <span class="progress-text">{{ lesson.number }}/{{ total_lessons|default(12) }}</span>
      <div class="progress-bar-mini">
        <div class="progress-fill-mini" style="width: {{ ((lesson.number / total_lessons|default(7)) * 100)|round }}%"></div>
      </div>
    </div>
  </div>

  {% if lesson.description or block_description %}
  <p class="lesson-description">{{ lesson.description or block_description|default('') }}</p>
  {% endif %}

  <!-- Instructions -->
  {% if instruction_text %}
  <div class="instruction-box">
    <i class="fas fa-info-circle"></i>
    <span>{{ instruction_text }}</span>
  </div>
  {% endif %}

  <!-- Main Content -->
  <div class="lesson-content">
    {% block lesson_content %}{% endblock %}
  </div>

  <!-- Navigation Footer -->
  <div class="lesson-footer" id="lesson-footer">
    {% block action_buttons %}
      <a href="{{ '/learn/' }}"
         class="btn-lesson btn-outline">
        â† {{ _('Ğš Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ') }}
      </a>

      <button type="button"
              class="btn-lesson btn-outline"
              id="retry-button"
              style="display: none;"
              onclick="retryLesson()">
        <i class="fas fa-redo"></i> {{ _('Ğ—Ğ°Ğ½Ğ¾Ğ²Ğ¾') }}
      </button>

      {% if next_lesson %}
        <button type="button"
                class="btn-lesson btn-primary"
                id="complete-exercise"
                style="display: none;"
                data-next-url="{{ url_for('curriculum_lessons.lesson_detail', lesson_id=next_lesson.id) }}"
                onclick="window.location.href=this.getAttribute('data-next-url')">
          {{ _('Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑƒÑ€Ğ¾Ğº') }} â†’
        </button>
      {% else %}
        <button type="button"
                class="btn-lesson btn-primary"
                id="complete-module"
                style="display: none;"
                onclick="window.location.href='{{ '/learn/' }}'">
          <i class="fas fa-check"></i> {{ _('Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ') }}
        </button>
      {% endif %}
    {% endblock %}
  </div>

</div>

<!-- CSRF Token Meta -->
<meta name="csrf-token" content="{{ csrf_token() }}">
{% endblock %}
