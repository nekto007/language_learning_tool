{% extends "base.html" %}

{% block title %}{{ _('Упражнение завершено') }}{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card text-center">
                <div class="card-header bg-success text-white">
                    <h2 class="mb-0">{{ _('Упражнение завершено!') }}</h2>
                </div>
                <div class="card-body">
                    <div class="congratulation-animation my-4">
                        <i class="fas fa-trophy fa-5x text-warning mb-3"></i>
                    </div>

                    <h3 class="mb-4">{{ _('Ваши результаты') }}</h3>

                    <div class="row stats">
                        <div class="col-md-4">
                            <div class="stat-card mb-3">
                                <div class="stat-value">{{ session.words_studied }}</div>
                                <div class="stat-label">{{ _('Слов изучено') }}</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card mb-3">
                                <div class="stat-value">{{ correct_percentage }}%</div>
                                <div class="stat-label">{{ _('Правильных ответов') }}</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card mb-3">
                                <div class="stat-value">{{ total_xp }} XP</div>
                                <div class="stat-label">{{ _('Опыт получен') }}</div>
                            </div>
                        </div>
                    </div>

                    <div class="time-info my-4">
                        <p>{{ _('Время выполнения:') }} <strong>{{ session.duration }}</strong> {{ _('минут') }}</p>
                    </div>

                    {% if new_level %}
                    <div class="level-up-notice alert alert-warning my-4">
                        <h4><i class="fas fa-level-up-alt me-2"></i> {{ _('Вы достигли нового уровня!') }}</h4>
                        <p>{{ _('Поздравляем! Вы перешли на уровень') }} <strong>{{ new_level }}</strong></p>
                    </div>
                    {% endif %}

                    <div class="action-buttons mt-4">
                        <a href="{{ url_for('study.index') }}" class="btn btn-primary btn-lg me-2">
                            <i class="fas fa-home me-2"></i> {{ _('На главную') }}
                        </a>
                        <a href="{{ url_for('exercises.start_exercise') }}" class="btn btn-success btn-lg">
                            <i class="fas fa-redo me-2"></i> {{ _('Ещё упражнение') }}
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.congratulation-animation {
    animation: pop 0.5s ease-out;
}

@keyframes pop {
    0% { transform: scale(0.5); opacity: 0; }
    80% { transform: scale(1.2); }
    100% { transform: scale(1); opacity: 1; }
}

.stat-card {
    background-color: #f8f9fa;
    border-radius: 10px;
    padding: 15px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.stat-value {
    font-size: 32px;
    font-weight: bold;
    color: #28a745;
}

.stat-label {
    font-size: 14px;
    color: #6c757d;
}

.level-up-notice {
    animation: glow 2s infinite alternate;
}

@keyframes glow {
    from {
        box-shadow: 0 0 5px -5px #ffbb33;
    }
    to {
        box-shadow: 0 0 15px 5px #ffbb33;
    }
}
</style>
{% endblock %}